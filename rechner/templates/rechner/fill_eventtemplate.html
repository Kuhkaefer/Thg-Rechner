{% extends 'rechner/base.html' %}

{% block title %}
{{ page_name }}
{% endblock %}

{% block header %}
    {{ page_header }}
{% endblock %}

{% block description %}
    {{page_description}}
{% endblock %}

{% block content %}

    <style>
        txt_grey {
            color: grey;
        }
        .hide {
            display: none;
        }
        .myDIV:hover + .hide {
            display: block;
            color: red;
        }
        ul {list-style: none; padding: 0; }
        li {position: relative; padding: 0 0 0 20px; list-style: none; }
        li:before {content: '-'; position: absolute; top: 0; left: 0;}

    </style>

    <p> </p>

    <form action="" method="POST" name="user-answers"> {% csrf_token %}
        <table id="q_table" style="width:100%">
            <tr>
              <td> &nbsp;&nbsp;&nbsp;</td>
              <th style="text-align:left">Allgemein</th>
            </tr>
            <tr>
                <td></td>
                <td colspan="1"> Name der Veranstaltung: </td>
                <td colspan="4">
                  {% autoescape off %}
                  <input type="text" name="event_name" maxlength="100" size="17" required value={{event_name}}>
                  {% endautoescape %}
                </td>
                <td> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
            </tr>
          <tr>
              <td></td>
              <td colspan="1"> Anzahl der Teilnehmenden (TN): </td>
              <td style="text-align:center">
                <input name="TNs" maxlength="18" size="5" required value={{TNs}} type="number" inputmode="decimal" min="0" step="1" class="my_input">
              </td>
          </tr>
            {% for q,d,first,last,has_unit,has_info,scale in q_v_f_l_u_i_and_s %}

<!--          Show category -->
                {% if first %}
                    <tr>
                      <th></th>
                      <th style="text-align:left" colspan="1">
                        <br>{{q.category}}</br>
                      </th>
                      <th style="font-weight:normal;color:grey;font-size:16;text-align:center;">
                         <br>Menge</br>
                       </th>
                      <th style="font-weight:normal;color:grey;font-size:16;text-align:center" title="Mit Teilnehmendenzahl skalieren">
                        <br>Â·TN</br>
                      </th>
                      <th style="font-weight:normal;color:grey;font-size:16;text-align:center" class="hide">
                        <br>Mit Zahl der Teilnehmenden multiplizieren</br>
                      </th>
                      <th></th>
                      <th></th>
                    </tr>
                {% endif %}

<!--          List questions -->
                <tr>
                    <td></td>
                    <td><li>{{q.question_text }} {% if has_unit %} [{{q.unit}}] {% endif %} </li></td>
                    <td style="text-align:center">
                        <input id="id_subject"  name={{q.id}} maxlength="20"
                               size="5" style="text-align:center" required value={{d}} type="number" inputmode="decimal"
                               lang="en" min="0" step="any" class="my_input">
                    </td>
                    <td style="text-align:center">
                        <input type="checkbox" name="scale{{q.id}}" {{scale}} style="float:center;text-align:center">
                    </td>
                    <td>
                            <!-- <div type='submit' name="enter" value=1 hidden="hidden">-</div>
                            <div type='submit' name="remove_field" value={{q.id}}
                              class="ar_btn remove_btn"><b>-</b></div> -->
                            <!-- <div style="display: inline-block"> <!-- class="ar_btn remove_btn">-->
                        <!-- <div type="" name="remove_field"
                                class="ar_btn remove_btn" onClick="document.forms['user-answers'].submit(value={{q.pk}});">-
                        </div> -->
                        <!-- <div style="width: 20px;">
                            <button style="width=100%" type='submit' name="remove_field" value={{q.id}} class="ar_btn remove_btn">-</button>
                        </div> -->

                      <button class="ar_btn remove_btn" name="remove_field" value={{q.id}} type='submit'>-</button>
                            <!-- </div> -->
                    </td>
<!--          Info Hint -->
                    <td>
                      {% if has_info %}
                       <!-- <div class="ar_btn info_btn" style="font-size:14" title="{{ q.info_text }} ">i</div> -->

                       <!-- <body> -->
                         <!-- <span class="hovertext" data-hover="{{ q.info_text }}"> -->
                         <div class="ar_btn info_btn hovertext" data-hover="{{ q.info_text }}"
                          style="font-size:14;font-weight:bold;float:right" >i</div>
                         <!-- </span> -->
                       <!-- </body> -->

                      <!-- <i class="fa-solid fa-circle-info"></i> -->
                            <!-- <div class = "myDIV" style="float:right;text-align:right"> (info) </div>
                            <div class = "hide"> {{q.info_text}} </div> -->

                             <!-- <div class="dropdown">
                             <div class="ar_btn info_btn" style="font-size:14">i</div>
                             <div class="info-content" >
                               <option name="info-text" width=100px> {{ q.info_text }} </option>
                             </div>
                            </div> -->
                      {% endif %}
                    </td>
                </tr>
                <tr>
                </tr>

<!--              Option to add question -->
                {% if last %}
                    <tr>
                      <td colspan="4"></td>
                      <td>
                        <div class="dropdown">
                         <div class="ar_btn add_btn">+</div>
                         <div class="dropdown-content left" >
                           {% for add_q in missing_qs %}
                             {% if add_q.category == q.category %}
                               <button type='submit' name="new_field" value={{add_q.id}}> {{ add_q.name }} </button>
                             {% endif %}
                           {% endfor %}
                         </div>
                        </div>
                      </td>
                    </tr>

                {% endif %}

            {% endfor %}
            <tr><td><br/></td></tr>

<!--      Option to add question of new category -->
            <tr>

              <td> </td>
              <td colspan="1">
                <div class="dropdown">
                 <div class="dropbtn" style="font-weight:bold">Neue Kategorie:</div>
                  <div class="dropdown-content"  >
                    {% for mc in missing_cats %}
                        <button type='submit' name="new_cat" value={{mc.id}} > {{ mc.name }} </button>
                    {% endfor %}
                  </div>
                </div>
              </td>
            </tr>
            {% if cat_added != None %}
                <tr>
                  <td> </td>
                  <td colspan="1" style="font-size:16"> Neuer Posten aus {{cat_added}}: </td>
                  <td colspan="2"> </td>
                  <td colspan="1">
                    <div class="dropdown">
                     <div class="ar_btn add_btn" >+</div>
                      <div class="dropdown-content left"  >
                        {% for mc in new_c_q_list %}
                          <button  type='submit' value={{mc.id}} name="new_field"> {{ mc.name }} </button>
                        {% endfor %}
                      </div>
                    </div>
                  </td>
                </tr>
            {% endif %}
        </table>
        <br>

<!--  Submit buttons -->
        <table>
            <tr>
                <td> <input type="submit" name="submit form" value="Submit" class="button green_button"> </td>
                <td> <input type="submit" name="reset" value="Reset" class="button orange_button"> </td>
                <td> <input type='button'  name="back" value="Back" onclick="location.href='{{button_link}}'" class="button red_button"> </td>
            </tr>
        </table>
    </form>

{% endblock %}
